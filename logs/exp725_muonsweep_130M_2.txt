2025-05-21 23:26:17,437	INFO ray_run.py:64 -- Dependencies extracted: ['draccus>=0.11.5', 'google-api-python-client~=2.0', 'gcsfs', 'google-cloud-storage', 'google-cloud-storage-transfer', 's3fs>=2024', 'regex', 'requests', 'numpy', 'torch', 'braceexpand', 'deepdiff', 'tqdm', 'tqdm-loggable', 'toml', 'pandas', 'pyarrow', 'multiprocess==0.70.16', 'levanter>=1.2.dev1359', 'haliax>=1.4.dev348', 'sentencepiece', 'lz4', 'wandb<=0.19.9']
2025-05-21 23:26:18,461	INFO ray_run.py:111 -- Submitting job with entrypoint:  python experiments/optimizer_sweep/PhaseI_Bound/exp725_muonsweep_130M_2.py --force_run_failed True
2025-05-21 23:26:18,462	INFO ray_run.py:112 -- Dependencies: [
    "draccus>=0.11.5",
    "google-api-python-client~=2.0",
    "gcsfs",
    "google-cloud-storage",
    "google-cloud-storage-transfer",
    "s3fs>=2024",
    "regex",
    "requests",
    "numpy",
    "torch",
    "braceexpand",
    "deepdiff",
    "tqdm",
    "tqdm-loggable",
    "toml",
    "pandas",
    "pyarrow",
    "multiprocess==0.70.16",
    "levanter>=1.2.dev1359",
    "haliax>=1.4.dev348",
    "sentencepiece",
    "lz4",
    "wandb<=0.19.9"
]
2025-05-21 23:26:18,462	INFO ray_run.py:113 -- env_vars: {
    "PYTHONPATH": "submodules/levanter:submodules/levanter/src:./submodules/levanter/src:${PYTHONPATH}",
    "LIBTPU_INIT_ARGS": "--xla_tpu_scoped_vmem_limit_kib=81920 --xla_enable_async_all_gather=true --xla_tpu_overlap_compute_collective_tc=true --xla_tpu_enable_async_collective_fusion_multiple_steps=true --xla_tpu_enable_async_collective_fusion=true --xla_tpu_enable_async_collective_fusion_fuse_all_gather=true --xla_tpu_enable_data_parallel_all_reduce_opt=true --xla_tpu_data_parallel_opt_different_sized_ops=true --xla_tpu_megacore_fusion_allow_ags=false --xla_enable_async_collective_permute=true --xla_tpu_enable_ag_backward_pipelining=true",
    "WANDB_API_KEY": "c10de4d92e8d3857f5ffe660fbcf7c4ae067b062"
}
2025-05-21 23:26:18,462	INFO ray_run.py:115 -- Terminal command: 
ray job submit --runtime-env-json '{"pip": ["draccus>=0.11.5", "google-api-python-client~=2.0", "gcsfs", "google-cloud-storage", "google-cloud-storage-transfer", "s3fs>=2024", "regex", "requests", "numpy", "torch", "braceexpand", "deepdiff", "tqdm", "tqdm-loggable", "toml", "pandas", "pyarrow", "multiprocess==0.70.16", "levanter>=1.2.dev1359", "haliax>=1.4.dev348", "sentencepiece", "lz4", "wandb<=0.19.9"], "working_dir": "/sailhome/kaiyue/TPU/marin-release/marin", "env_vars": {"PYTHONPATH": "submodules/levanter:submodules/levanter/src:./submodules/levanter/src:${PYTHONPATH}", "LIBTPU_INIT_ARGS": "--xla_tpu_scoped_vmem_limit_kib=81920 --xla_enable_async_all_gather=true --xla_tpu_overlap_compute_collective_tc=true --xla_tpu_enable_async_collective_fusion_multiple_steps=true --xla_tpu_enable_async_collective_fusion=true --xla_tpu_enable_async_collective_fusion_fuse_all_gather=true --xla_tpu_enable_data_parallel_all_reduce_opt=true --xla_tpu_data_parallel_opt_different_sized_ops=true --xla_tpu_megacore_fusion_allow_ags=false --xla_enable_async_collective_permute=true --xla_tpu_enable_ag_backward_pipelining=true", "WANDB_API_KEY": "c10de4d92e8d3857f5ffe660fbcf7c4ae067b062"}, "config": {"setup_timeout_seconds": 1800}, "excludes": ["logs/exp725_muonsweep_130M_2.txt", "logs/exp725_scionsweep_130M_8.txt", "logs/exp725_scionsweep_300M_1.txt", "logs/exp725_cautioussweep_130M_8.txt", "logs/exp725_cautioussweep_300M_1.txt", "logs/exp725_muonsweep_520M_1.txt", "logs/exp725_muonsweep_130M_4.txt", "logs/exp725_cautioussweep_130M_1.txt", "logs/exp725_nadamwsweep_130M_8.txt", "logs/exp725_nadamwsweep_300M_1.txt", "logs/exp725_nadamwsweep_130M_1.txt", "logs/exp725_marssweep_130M_8.txt", "logs/exp725_marssweep_300M_1.txt", "logs/exp725_minisweep_300M_1.txt", "logs/exp725_soapesweep_130M_1.txt", "logs/exp725_scionsweep_130M_4.txt", "logs/exp725_scionsweep_520M_1.txt", "logs/exp725_soapesweep_130M_2.txt", "logs/exp725_cautioussweep_130M_2.txt", "logs/exp725_marssweep_130M_2.txt", "logs/exp725_nadamwsweep_130M_2.txt", "logs/exp725_minisweep_520M_1.txt", "logs/exp725_nadamwsweep_520M_1.txt", "logs/exp725_nadamwsweep_130M_4.txt", "logs/exp725_marssweep_130M_4.txt", "logs/exp725_marssweep_520M_1.txt", "logs/exp725_cautioussweep_130M_4.txt", "logs/exp725_cautioussweep_520M_1.txt", "logs/exp725_muonsweep_300M_1.txt", "logs/exp725_muonsweep_130M_8.txt", ".git/HEAD", ".git/objects", ".git/config", ".git/logs", ".git/index", ".git/branches", ".git/COMMIT_EDITMSG", ".git/info", ".git/description", ".git/packed-refs", ".git/refs", ".git/hooks"]}' --  python experiments/optimizer_sweep/PhaseI_Bound/exp725_muonsweep_130M_2.py --force_run_failed True
2025-05-21 23:26:20,023	INFO dashboard_sdk.py:338 -- Uploading package gcs://_ray_pkg_7ee52735570f7032.zip.
2025-05-21 23:26:20,024	INFO packaging.py:576 -- Creating a file package for local module '/sailhome/kaiyue/TPU/marin-release/marin'.
2025-05-21 23:26:26,581	INFO ray_run.py:120 -- Job submitted with ID: raysubmit_FzHyJsQbucpeccYx
2025-05-21 23:26:26,581	INFO ray_run.py:121 -- Job URL: http://localhost:8265/#/jobs/raysubmit_FzHyJsQbucpeccYx
['logs/exp725_muonsweep_130M_2.txt', 'logs/exp725_scionsweep_130M_8.txt', 'logs/exp725_scionsweep_300M_1.txt', 'logs/exp725_cautioussweep_130M_8.txt', 'logs/exp725_cautioussweep_300M_1.txt', 'logs/exp725_muonsweep_520M_1.txt', 'logs/exp725_muonsweep_130M_4.txt', 'logs/exp725_cautioussweep_130M_1.txt', 'logs/exp725_nadamwsweep_130M_8.txt', 'logs/exp725_nadamwsweep_300M_1.txt', 'logs/exp725_nadamwsweep_130M_1.txt', 'logs/exp725_marssweep_130M_8.txt', 'logs/exp725_marssweep_300M_1.txt', 'logs/exp725_minisweep_300M_1.txt', 'logs/exp725_soapesweep_130M_1.txt', 'logs/exp725_scionsweep_130M_4.txt', 'logs/exp725_scionsweep_520M_1.txt', 'logs/exp725_soapesweep_130M_2.txt', 'logs/exp725_cautioussweep_130M_2.txt', 'logs/exp725_marssweep_130M_2.txt', 'logs/exp725_nadamwsweep_130M_2.txt', 'logs/exp725_minisweep_520M_1.txt', 'logs/exp725_nadamwsweep_520M_1.txt', 'logs/exp725_nadamwsweep_130M_4.txt', 'logs/exp725_marssweep_130M_4.txt', 'logs/exp725_marssweep_520M_1.txt', 'logs/exp725_cautioussweep_130M_4.txt', 'logs/exp725_cautioussweep_520M_1.txt', 'logs/exp725_muonsweep_300M_1.txt', 'logs/exp725_muonsweep_130M_8.txt', '.git/HEAD', '.git/objects', '.git/config', '.git/logs', '.git/index', '.git/branches', '.git/COMMIT_EDITMSG', '.git/info', '.git/description', '.git/packed-refs', '.git/refs', '.git/hooks']
2025-05-21 23:26:26,497	INFO job_manager.py:528 -- Runtime env is setting up.
['/home/ray/anaconda3/lib/python3.11/site-packages/ray/thirdparty_files', '/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/working_dir_files/_ray_pkg_7ee52735570f7032/experiments/optimizer_sweep/PhaseI_Bound', '/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/working_dir_files/_ray_pkg_7ee52735570f7032', '/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/working_dir_files/_ray_pkg_7ee52735570f7032/submodules/levanter', '/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/working_dir_files/_ray_pkg_7ee52735570f7032/submodules/levanter/src', '/home/ray/anaconda3/lib/python311.zip', '/home/ray/anaconda3/lib/python3.11', '/home/ray/anaconda3/lib/python3.11/lib-dynload', '/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/pip/1c7729883f499988ae1c2eb9d635f02bf39f3b05/virtualenv/lib/python3.11/site-packages', '/home/ray/anaconda3/lib/python3.11/site-packages']
('130m', '5B', 'muon')
3.369025468826294
Current best config: {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-05, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}
Current Approximate best config: [{'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-25, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}, {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-25, 'muon_epsilon': 1e-05, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}, {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-05, 'max_grad_norm': 0, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}, {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-05, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}, {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.95, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-05, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}, {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-10, 'muon_epsilon': 1e-05, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}, {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-15, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}, {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-05, 'max_grad_norm': 2, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}, {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-20, 'muon_epsilon': 1e-05, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}, {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-20, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}, {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.9, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-05, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}, {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-05, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.6, 'train_batch_size': 128}, {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-10, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}]
Unfinished: {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-05, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.4, 'decay': 0.8, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.004, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-25, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-25, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.4, 'decay': 0.8, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.004, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-25, 'muon_epsilon': 1e-05, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-25, 'muon_epsilon': 1e-05, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.4, 'decay': 0.8, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.004, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-05, 'max_grad_norm': 0, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-05, 'max_grad_norm': 0, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.4, 'decay': 0.8, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-05, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.4, 'decay': 0.8, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.004, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.95, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-05, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.95, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-05, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.4, 'decay': 0.8, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.004, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-10, 'muon_epsilon': 1e-05, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-10, 'muon_epsilon': 1e-05, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.4, 'decay': 0.8, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.004, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-15, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-15, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.4, 'decay': 0.8, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.004, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-05, 'max_grad_norm': 2, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-05, 'max_grad_norm': 2, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.4, 'decay': 0.8, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.004, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-20, 'muon_epsilon': 1e-05, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-20, 'muon_epsilon': 1e-05, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.4, 'decay': 0.8, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.004, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-20, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-20, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.4, 'decay': 0.8, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.004, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.9, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-05, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.9, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-05, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.4, 'decay': 0.8, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.004, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-05, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.6, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-05, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.4, 'decay': 0.6, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.004, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-10, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}
Unfinished: {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-10, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.4, 'decay': 0.8, 'train_batch_size': 128}
All configs are nearly equally close to finish
Choose: {'learning_rate': 0.008, 'weight_decay': 0.1, 'min_lr_ratio': 0, 'warmup': 0, 'momentum': 0.98, 'beta1': 0.8, 'beta2': 0.98, 'epsilon': 1e-15, 'muon_epsilon': 1e-05, 'max_grad_norm': 1, 'lr_schedule': 'linear', 'muon_to_adam_lr': 0.3, 'decay': 0.8, 'train_batch_size': 128}
Closest to finish: 1
2025-05-21 23:26:47,798	INFO worker.py:1461 -- Using address 10.164.0.238:6379 set in the environment variable RAY_ADDRESS
2025-05-21 23:26:47,798	INFO worker.py:1601 -- Connecting to existing Ray cluster at address: 10.164.0.238:6379...
2025-05-21 23:26:47,838	INFO worker.py:1777 -- Connected to Ray cluster. View the dashboard at [1m[32mhttp://10.164.0.238:8265 [39m[22m
2025-05-21 23:26:50,536	INFO executor.py:1085 -- Ray init took 2.74s
2025-05-21 23:26:50,771	INFO executor.py:550 -- ### Inspecting the 1 provided steps ###
2025-05-21 23:26:50,772	WARNING executor.py:677 -- Output path gs://marin-eu-west4/raw/dclm-baseline-1.0-ba19eb doesn't match given override raw/dclm, using the latter.
2025-05-21 23:26:50,772	WARNING executor.py:677 -- Output path gs://marin-eu-west4/tokenized/dclm_baseline-951f3f doesn't match given override tokenized/dclm_baseline-0206f1/, using the latter.
2025-05-21 23:26:50,773	WARNING executor.py:677 -- Output path gs://marin-eu-west4/raw/starcoderdata-29d91d doesn't match given override raw/starcoderdata-720c8c, using the latter.
2025-05-21 23:26:50,773	WARNING executor.py:677 -- Output path gs://marin-eu-west4/tokenized/starcoderdata-377a39 doesn't match given override tokenized/starcoderdata-12f018/, using the latter.
2025-05-21 23:26:50,773	WARNING executor.py:677 -- Output path gs://marin-eu-west4/raw/proof-pile-2-67a30b doesn't match given override raw/proof-pile-2-f1b1d8, using the latter.
2025-05-21 23:26:50,773	WARNING executor.py:677 -- Output path gs://marin-eu-west4/tokenized/proofpile_2-4a35c7 doesn't match given override tokenized/proofpile_2-4a35c7/, using the latter.
2025-05-21 23:26:50,779	INFO executor.py:558 -- ### Reading 24 statuses ###
2025-05-21 23:26:50,779	INFO executor.py:568 -- ### Launching 24 steps ###
2025-05-21 23:26:50,779	INFO executor.py:802 -- raw/dclm-baseline-1.0: operations.download.huggingface.download.download
2025-05-21 23:26:50,779	INFO executor.py:803 --   output_path = gs://marin-eu-west4/raw/dclm
2025-05-21 23:26:50,779	INFO executor.py:804 --   config = {}
2025-05-21 23:26:50,811	INFO executor.py:802 -- tokenized/dclm_baseline: marin.processing.tokenize.tokenize.tokenize
2025-05-21 23:26:50,811	INFO executor.py:803 --   output_path = gs://marin-eu-west4/tokenized/dclm_baseline-0206f1/
2025-05-21 23:26:50,811	INFO executor.py:804 --   config = {"train_paths.[0]": "DEP[0]/a3b142c", "tokenizer": "meta-llama/Meta-Llama-3.1-8B"}
2025-05-21 23:26:50,811	INFO executor.py:806 --   DEP[0] = gs://marin-eu-west4/raw/dclm
2025-05-21 23:26:50,829	INFO executor.py:802 -- raw/starcoderdata: operations.download.huggingface.download_hf.download_hf
2025-05-21 23:26:50,829	INFO executor.py:803 --   output_path = gs://marin-eu-west4/raw/starcoderdata-720c8c
2025-05-21 23:26:50,829	INFO executor.py:804 --   config = {}
2025-05-21 23:26:50,830	INFO executor.py:802 -- tokenized/starcoderdata: marin.processing.tokenize.tokenize.tokenize
2025-05-21 23:26:50,830	INFO executor.py:803 --   output_path = gs://marin-eu-west4/tokenized/starcoderdata-12f018/
2025-05-21 23:26:50,830	INFO executor.py:804 --   config = {"train_paths.[0]": "DEP[0]", "tokenizer": "meta-llama/Meta-Llama-3.1-8B"}
2025-05-21 23:26:50,830	INFO executor.py:806 --   DEP[0] = gs://marin-eu-west4/raw/starcoderdata-720c8c
2025-05-21 23:26:50,837	INFO executor.py:802 -- raw/proof-pile-2: operations.download.huggingface.download.download
2025-05-21 23:26:50,837	INFO executor.py:803 --   output_path = gs://marin-eu-west4/raw/proof-pile-2-f1b1d8
2025-05-21 23:26:50,837	INFO executor.py:804 --   config = {}
2025-05-21 23:26:50,838	INFO executor.py:802 -- tokenized/proofpile_2: marin.processing.tokenize.tokenize.tokenize
2025-05-21 23:26:50,838	INFO executor.py:803 --   output_path = gs://marin-eu-west4/tokenized/proofpile_2-4a35c7/
2025-05-21 23:26:50,838	INFO executor.py:804 --   config = {"train_paths.[0]": "DEP[0]/901a927/huggingface.co/datasets/EleutherAI/proof-pile-2/resolve/901a927", "tokenizer": "meta-llama/Meta-Llama-3.1-8B"}
2025-05-21 23:26:50,838	INFO executor.py:806 --   DEP[0] = gs://marin-eu-west4/raw/proof-pile-2-f1b1d8
2025-05-21 23:26:50,847	INFO executor.py:802 -- raw/paloma: operations.download.huggingface.download_gated_manual.download_and_upload_to_store
2025-05-21 23:26:50,847	INFO executor.py:803 --   output_path = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,847	INFO executor.py:804 --   config = {"hf_dataset_id": "allenai/paloma", "revision": "65cd6fc"}
2025-05-21 23:26:50,848	INFO executor.py:802 -- tokenized/paloma/4chan: marin.processing.tokenize.tokenize.tokenize
2025-05-21 23:26:50,848	INFO executor.py:803 --   output_path = gs://marin-eu-west4/tokenized/paloma/4chan-496ad5
2025-05-21 23:26:50,848	INFO executor.py:804 --   config = {"validation_paths.[0]": "DEP[0]/65cd6fc/4chan_meta_sep/val/val*.jsonl.gz", "tokenizer": "meta-llama/Meta-Llama-3.1-8B"}
2025-05-21 23:26:50,848	INFO executor.py:806 --   DEP[0] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,855	INFO executor.py:802 -- tokenized/paloma/c4_100_domains: marin.processing.tokenize.tokenize.tokenize
2025-05-21 23:26:50,855	INFO executor.py:803 --   output_path = gs://marin-eu-west4/tokenized/paloma/c4_100_domains-2b6db7
2025-05-21 23:26:50,855	INFO executor.py:804 --   config = {"validation_paths.[0]": "DEP[0]/65cd6fc/c4_100_domains/val/val*.jsonl.gz", "tokenizer": "meta-llama/Meta-Llama-3.1-8B"}
2025-05-21 23:26:50,855	INFO executor.py:806 --   DEP[0] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,862	INFO executor.py:802 -- tokenized/paloma/c4_en: marin.processing.tokenize.tokenize.tokenize
2025-05-21 23:26:50,862	INFO executor.py:803 --   output_path = gs://marin-eu-west4/tokenized/paloma/c4_en-cf1f79
2025-05-21 23:26:50,862	INFO executor.py:804 --   config = {"validation_paths.[0]": "DEP[0]/65cd6fc/c4_en/val/val*.jsonl.gz", "tokenizer": "meta-llama/Meta-Llama-3.1-8B"}
2025-05-21 23:26:50,862	INFO executor.py:806 --   DEP[0] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,870	INFO executor.py:802 -- tokenized/paloma/dolma-v1_5: marin.processing.tokenize.tokenize.tokenize
2025-05-21 23:26:50,870	INFO executor.py:803 --   output_path = gs://marin-eu-west4/tokenized/paloma/dolma-v1_5-d3bed7
2025-05-21 23:26:50,870	INFO executor.py:804 --   config = {"validation_paths.[0]": "DEP[0]/65cd6fc/dolma-v1_5/val/val*.jsonl.gz", "tokenizer": "meta-llama/Meta-Llama-3.1-8B"}
2025-05-21 23:26:50,870	INFO executor.py:806 --   DEP[0] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,876	INFO executor.py:802 -- tokenized/paloma/dolma_100_programing_languages: marin.processing.tokenize.tokenize.tokenize
2025-05-21 23:26:50,876	INFO executor.py:803 --   output_path = gs://marin-eu-west4/tokenized/paloma/dolma_100_programing_languages-369132
2025-05-21 23:26:50,876	INFO executor.py:804 --   config = {"validation_paths.[0]": "DEP[0]/65cd6fc/dolma_100_programing_languages/val/val*.jsonl.gz", "tokenizer": "meta-llama/Meta-Llama-3.1-8B"}
2025-05-21 23:26:50,876	INFO executor.py:806 --   DEP[0] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,883	INFO executor.py:802 -- tokenized/paloma/dolma_100_subreddits: marin.processing.tokenize.tokenize.tokenize
2025-05-21 23:26:50,883	INFO executor.py:803 --   output_path = gs://marin-eu-west4/tokenized/paloma/dolma_100_subreddits-f25f70
2025-05-21 23:26:50,883	INFO executor.py:804 --   config = {"validation_paths.[0]": "DEP[0]/65cd6fc/dolma_100_subreddits/val/val*.jsonl.gz", "tokenizer": "meta-llama/Meta-Llama-3.1-8B"}
2025-05-21 23:26:50,883	INFO executor.py:806 --   DEP[0] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,889	INFO executor.py:802 -- tokenized/paloma/falcon-refinedweb: marin.processing.tokenize.tokenize.tokenize
2025-05-21 23:26:50,889	INFO executor.py:803 --   output_path = gs://marin-eu-west4/tokenized/paloma/falcon-refinedweb-75d43b
2025-05-21 23:26:50,889	INFO executor.py:804 --   config = {"validation_paths.[0]": "DEP[0]/65cd6fc/falcon-refinedweb/val/val*.jsonl.gz", "tokenizer": "meta-llama/Meta-Llama-3.1-8B"}
2025-05-21 23:26:50,889	INFO executor.py:806 --   DEP[0] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,895	INFO executor.py:802 -- tokenized/paloma/gab: marin.processing.tokenize.tokenize.tokenize
2025-05-21 23:26:50,896	INFO executor.py:803 --   output_path = gs://marin-eu-west4/tokenized/paloma/gab-ccaced
2025-05-21 23:26:50,896	INFO executor.py:804 --   config = {"validation_paths.[0]": "DEP[0]/65cd6fc/gab/val/val*.jsonl.gz", "tokenizer": "meta-llama/Meta-Llama-3.1-8B"}
2025-05-21 23:26:50,896	INFO executor.py:806 --   DEP[0] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,904	INFO executor.py:802 -- tokenized/paloma/m2d2_s2orc_unsplit: marin.processing.tokenize.tokenize.tokenize
2025-05-21 23:26:50,904	INFO executor.py:803 --   output_path = gs://marin-eu-west4/tokenized/paloma/m2d2_s2orc_unsplit-7dbcc1
2025-05-21 23:26:50,904	INFO executor.py:804 --   config = {"validation_paths.[0]": "DEP[0]/65cd6fc/m2d2_s2orc_unsplit/val/val*.jsonl.gz", "tokenizer": "meta-llama/Meta-Llama-3.1-8B"}
2025-05-21 23:26:50,904	INFO executor.py:806 --   DEP[0] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,910	INFO executor.py:802 -- tokenized/paloma/m2d2_wikipedia_unsplit: marin.processing.tokenize.tokenize.tokenize
2025-05-21 23:26:50,910	INFO executor.py:803 --   output_path = gs://marin-eu-west4/tokenized/paloma/m2d2_wikipedia_unsplit-b33d23
2025-05-21 23:26:50,910	INFO executor.py:804 --   config = {"validation_paths.[0]": "DEP[0]/65cd6fc/m2d2_wikipedia_unsplit/val/val*.jsonl.gz", "tokenizer": "meta-llama/Meta-Llama-3.1-8B"}
2025-05-21 23:26:50,910	INFO executor.py:806 --   DEP[0] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,917	INFO executor.py:802 -- tokenized/paloma/manosphere_meta_sep: marin.processing.tokenize.tokenize.tokenize
2025-05-21 23:26:50,917	INFO executor.py:803 --   output_path = gs://marin-eu-west4/tokenized/paloma/manosphere_meta_sep-a07891
2025-05-21 23:26:50,917	INFO executor.py:804 --   config = {"validation_paths.[0]": "DEP[0]/65cd6fc/manosphere_meta_sep/val/val*.jsonl.gz", "tokenizer": "meta-llama/Meta-Llama-3.1-8B"}
2025-05-21 23:26:50,917	INFO executor.py:806 --   DEP[0] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,924	INFO executor.py:802 -- tokenized/paloma/mc4: marin.processing.tokenize.tokenize.tokenize
2025-05-21 23:26:50,924	INFO executor.py:803 --   output_path = gs://marin-eu-west4/tokenized/paloma/mc4-ea36a2
2025-05-21 23:26:50,924	INFO executor.py:804 --   config = {"validation_paths.[0]": "DEP[0]/65cd6fc/mc4/val/val*.jsonl.gz", "tokenizer": "meta-llama/Meta-Llama-3.1-8B"}
2025-05-21 23:26:50,924	INFO executor.py:806 --   DEP[0] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,933	INFO executor.py:802 -- tokenized/paloma/ptb: marin.processing.tokenize.tokenize.tokenize
2025-05-21 23:26:50,933	INFO executor.py:803 --   output_path = gs://marin-eu-west4/tokenized/paloma/ptb-628036
2025-05-21 23:26:50,933	INFO executor.py:804 --   config = {"validation_paths.[0]": "DEP[0]/65cd6fc/ptb/val/val*.jsonl.gz", "tokenizer": "meta-llama/Meta-Llama-3.1-8B"}
2025-05-21 23:26:50,933	INFO executor.py:806 --   DEP[0] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,939	INFO executor.py:802 -- tokenized/paloma/redpajama: marin.processing.tokenize.tokenize.tokenize
2025-05-21 23:26:50,939	INFO executor.py:803 --   output_path = gs://marin-eu-west4/tokenized/paloma/redpajama-9d4ddd
2025-05-21 23:26:50,939	INFO executor.py:804 --   config = {"validation_paths.[0]": "DEP[0]/65cd6fc/redpajama/val/val*.jsonl.gz", "tokenizer": "meta-llama/Meta-Llama-3.1-8B"}
2025-05-21 23:26:50,939	INFO executor.py:806 --   DEP[0] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,947	INFO executor.py:802 -- tokenized/paloma/twitterAAE_HELM_fixed: marin.processing.tokenize.tokenize.tokenize
2025-05-21 23:26:50,947	INFO executor.py:803 --   output_path = gs://marin-eu-west4/tokenized/paloma/twitterAAE_HELM_fixed-2e17c1
2025-05-21 23:26:50,947	INFO executor.py:804 --   config = {"validation_paths.[0]": "DEP[0]/65cd6fc/twitterAAE_HELM_fixed/val/val*.jsonl.gz", "tokenizer": "meta-llama/Meta-Llama-3.1-8B"}
2025-05-21 23:26:50,947	INFO executor.py:806 --   DEP[0] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,955	INFO executor.py:802 -- tokenized/paloma/wikitext_103: marin.processing.tokenize.tokenize.tokenize
2025-05-21 23:26:50,955	INFO executor.py:803 --   output_path = gs://marin-eu-west4/tokenized/paloma/wikitext_103-1f5636
2025-05-21 23:26:50,956	INFO executor.py:804 --   config = {"validation_paths.[0]": "DEP[0]/65cd6fc/wikitext_103/val/val*.jsonl.gz", "tokenizer": "meta-llama/Meta-Llama-3.1-8B"}
2025-05-21 23:26:50,956	INFO executor.py:806 --   DEP[0] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,964	INFO executor.py:802 -- checkpoints/sweep-130m-5B-muony4ca27elr0.008-wd0.1-minlr0-warmup0-b10.8-b20.: marin.optimizer_sweep.utils._failure_ok_train
2025-05-21 23:26:50,964	INFO executor.py:803 --   output_path = gs://marin-eu-west4/checkpoints/sweep-130m-5B-muony4ca27elr0.008-wd0.1-minlr0-warmup0-b10.8-b20.-8fd754
2025-05-21 23:26:50,964	INFO executor.py:804 --   config = {"train_config.data.tokenizer": "meta-llama/Meta-Llama-3.1-8B", "train_config.data.configs.dclm_baseline.cache_dir": "DEP[0]", "train_config.data.configs.dclm_baseline.train_urls.[0]": "DEP[1]/a3b142c", "train_config.data.configs.starcoderdata.cache_dir": "DEP[2]", "train_config.data.configs.starcoderdata.train_urls.[0]": "DEP[3]", "train_config.data.configs.proofpile_2.cache_dir": "DEP[4]", "train_config.data.configs.proofpile_2.train_urls.[0]": "DEP[5]/901a927/huggingface.co/datasets/EleutherAI/proof-pile-2/resolve/901a927", "train_config.data.configs.paloma/4chan.cache_dir": "DEP[6]", "train_config.data.configs.paloma/4chan.validation_urls.[0]": "DEP[7]/65cd6fc/4chan_meta_sep/val/val*.jsonl.gz", "train_config.data.configs.paloma/c4_100_domains.cache_dir": "DEP[8]", "train_config.data.configs.paloma/c4_100_domains.validation_urls.[0]": "DEP[9]/65cd6fc/c4_100_domains/val/val*.jsonl.gz", "train_config.data.configs.paloma/c4_en.cache_dir": "DEP[10]", "train_config.data.configs.paloma/c4_en.validation_urls.[0]": "DEP[11]/65cd6fc/c4_en/val/val*.jsonl.gz", "train_config.data.configs.paloma/dolma-v1_5.cache_dir": "DEP[12]", "train_config.data.configs.paloma/dolma-v1_5.validation_urls.[0]": "DEP[13]/65cd6fc/dolma-v1_5/val/val*.jsonl.gz", "train_config.data.configs.paloma/dolma_100_programing_languages.cache_dir": "DEP[14]", "train_config.data.configs.paloma/dolma_100_programing_languages.validation_urls.[0]": "DEP[15]/65cd6fc/dolma_100_programing_languages/val/val*.jsonl.gz", "train_config.data.configs.paloma/dolma_100_subreddits.cache_dir": "DEP[16]", "train_config.data.configs.paloma/dolma_100_subreddits.validation_urls.[0]": "DEP[17]/65cd6fc/dolma_100_subreddits/val/val*.jsonl.gz", "train_config.data.configs.paloma/falcon-refinedweb.cache_dir": "DEP[18]", "train_config.data.configs.paloma/falcon-refinedweb.validation_urls.[0]": "DEP[19]/65cd6fc/falcon-refinedweb/val/val*.jsonl.gz", "train_config.data.configs.paloma/gab.cache_dir": "DEP[20]", "train_config.data.configs.paloma/gab.validation_urls.[0]": "DEP[21]/65cd6fc/gab/val/val*.jsonl.gz", "train_config.data.configs.paloma/m2d2_s2orc_unsplit.cache_dir": "DEP[22]", "train_config.data.configs.paloma/m2d2_s2orc_unsplit.validation_urls.[0]": "DEP[23]/65cd6fc/m2d2_s2orc_unsplit/val/val*.jsonl.gz", "train_config.data.configs.paloma/m2d2_wikipedia_unsplit.cache_dir": "DEP[24]", "train_config.data.configs.paloma/m2d2_wikipedia_unsplit.validation_urls.[0]": "DEP[25]/65cd6fc/m2d2_wikipedia_unsplit/val/val*.jsonl.gz", "train_config.data.configs.paloma/manosphere_meta_sep.cache_dir": "DEP[26]", "train_config.data.configs.paloma/manosphere_meta_sep.validation_urls.[0]": "DEP[27]/65cd6fc/manosphere_meta_sep/val/val*.jsonl.gz", "train_config.data.configs.paloma/mc4.cache_dir": "DEP[28]", "train_config.data.configs.paloma/mc4.validation_urls.[0]": "DEP[29]/65cd6fc/mc4/val/val*.jsonl.gz", "train_config.data.configs.paloma/ptb.cache_dir": "DEP[30]", "train_config.data.configs.paloma/ptb.validation_urls.[0]": "DEP[31]/65cd6fc/ptb/val/val*.jsonl.gz", "train_config.data.configs.paloma/redpajama.cache_dir": "DEP[32]", "train_config.data.configs.paloma/redpajama.validation_urls.[0]": "DEP[33]/65cd6fc/redpajama/val/val*.jsonl.gz", "train_config.data.configs.paloma/twitterAAE_HELM_fixed.cache_dir": "DEP[34]", "train_config.data.configs.paloma/twitterAAE_HELM_fixed.validation_urls.[0]": "DEP[35]/65cd6fc/twitterAAE_HELM_fixed/val/val*.jsonl.gz", "train_config.data.configs.paloma/wikitext_103.cache_dir": "DEP[36]", "train_config.data.configs.paloma/wikitext_103.validation_urls.[0]": "DEP[37]/65cd6fc/wikitext_103/val/val*.jsonl.gz", "resources.tpu_type": "v5litepod-128"}
2025-05-21 23:26:50,964	INFO executor.py:806 --   DEP[0] = gs://marin-eu-west4/tokenized/dclm_baseline-0206f1/
2025-05-21 23:26:50,964	INFO executor.py:806 --   DEP[1] = gs://marin-eu-west4/raw/dclm
2025-05-21 23:26:50,964	INFO executor.py:806 --   DEP[2] = gs://marin-eu-west4/tokenized/starcoderdata-12f018/
2025-05-21 23:26:50,964	INFO executor.py:806 --   DEP[3] = gs://marin-eu-west4/raw/starcoderdata-720c8c
2025-05-21 23:26:50,964	INFO executor.py:806 --   DEP[4] = gs://marin-eu-west4/tokenized/proofpile_2-4a35c7/
2025-05-21 23:26:50,964	INFO executor.py:806 --   DEP[5] = gs://marin-eu-west4/raw/proof-pile-2-f1b1d8
2025-05-21 23:26:50,964	INFO executor.py:806 --   DEP[6] = gs://marin-eu-west4/tokenized/paloma/4chan-496ad5
2025-05-21 23:26:50,964	INFO executor.py:806 --   DEP[7] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,964	INFO executor.py:806 --   DEP[8] = gs://marin-eu-west4/tokenized/paloma/c4_100_domains-2b6db7
2025-05-21 23:26:50,964	INFO executor.py:806 --   DEP[9] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,964	INFO executor.py:806 --   DEP[10] = gs://marin-eu-west4/tokenized/paloma/c4_en-cf1f79
2025-05-21 23:26:50,964	INFO executor.py:806 --   DEP[11] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,964	INFO executor.py:806 --   DEP[12] = gs://marin-eu-west4/tokenized/paloma/dolma-v1_5-d3bed7
2025-05-21 23:26:50,964	INFO executor.py:806 --   DEP[13] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,964	INFO executor.py:806 --   DEP[14] = gs://marin-eu-west4/tokenized/paloma/dolma_100_programing_languages-369132
2025-05-21 23:26:50,964	INFO executor.py:806 --   DEP[15] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,964	INFO executor.py:806 --   DEP[16] = gs://marin-eu-west4/tokenized/paloma/dolma_100_subreddits-f25f70
2025-05-21 23:26:50,964	INFO executor.py:806 --   DEP[17] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,965	INFO executor.py:806 --   DEP[18] = gs://marin-eu-west4/tokenized/paloma/falcon-refinedweb-75d43b
2025-05-21 23:26:50,965	INFO executor.py:806 --   DEP[19] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,965	INFO executor.py:806 --   DEP[20] = gs://marin-eu-west4/tokenized/paloma/gab-ccaced
2025-05-21 23:26:50,965	INFO executor.py:806 --   DEP[21] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,965	INFO executor.py:806 --   DEP[22] = gs://marin-eu-west4/tokenized/paloma/m2d2_s2orc_unsplit-7dbcc1
2025-05-21 23:26:50,965	INFO executor.py:806 --   DEP[23] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,965	INFO executor.py:806 --   DEP[24] = gs://marin-eu-west4/tokenized/paloma/m2d2_wikipedia_unsplit-b33d23
2025-05-21 23:26:50,965	INFO executor.py:806 --   DEP[25] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,965	INFO executor.py:806 --   DEP[26] = gs://marin-eu-west4/tokenized/paloma/manosphere_meta_sep-a07891
2025-05-21 23:26:50,965	INFO executor.py:806 --   DEP[27] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,965	INFO executor.py:806 --   DEP[28] = gs://marin-eu-west4/tokenized/paloma/mc4-ea36a2
2025-05-21 23:26:50,965	INFO executor.py:806 --   DEP[29] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,965	INFO executor.py:806 --   DEP[30] = gs://marin-eu-west4/tokenized/paloma/ptb-628036
2025-05-21 23:26:50,965	INFO executor.py:806 --   DEP[31] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,965	INFO executor.py:806 --   DEP[32] = gs://marin-eu-west4/tokenized/paloma/redpajama-9d4ddd
2025-05-21 23:26:50,965	INFO executor.py:806 --   DEP[33] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,965	INFO executor.py:806 --   DEP[34] = gs://marin-eu-west4/tokenized/paloma/twitterAAE_HELM_fixed-2e17c1
2025-05-21 23:26:50,965	INFO executor.py:806 --   DEP[35] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,965	INFO executor.py:806 --   DEP[36] = gs://marin-eu-west4/tokenized/paloma/wikitext_103-1f5636
2025-05-21 23:26:50,965	INFO executor.py:806 --   DEP[37] = gs://marin-eu-west4/raw/paloma-fc6827
2025-05-21 23:26:50,971	INFO executor.py:572 -- ### Writing metadata ###
2025-05-21 23:26:50,977	WARNING json_encoder.py:23 -- Could not serialize object of type <enum 'AttentionBackend'>: AttentionBackend.JAX_FLASH
2025-05-21 23:26:50,977	INFO executor.py:768 -- Writing executor info to gs://marin-eu-west4/experiments/exp725_muonsweep_130M_2-e3bb4b.json
2025-05-21 23:26:50,977	INFO executor.py:769 -- To view the experiment page, go to:
2025-05-21 23:26:50,977	INFO executor.py:770 -- 
2025-05-21 23:26:50,978	INFO executor.py:771 -- https://crfm.stanford.edu/marin/data_browser/experiment?path=gs%3A//marin-eu-west4/experiments/exp725_muonsweep_130M_2-e3bb4b.json
2025-05-21 23:26:50,978	INFO executor.py:772 -- 
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m No module named 'jaxlib.xla_extension'
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m Traceback (most recent call last):
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "/home/ray/anaconda3/lib/python3.11/site-packages/ray/_private/serialization.py", line 423, in deserialize_objects
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m     obj = self._deserialize_object(data, metadata, object_ref)
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "/home/ray/anaconda3/lib/python3.11/site-packages/ray/_private/serialization.py", line 280, in _deserialize_object
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m     return self._deserialize_msgpack_data(data, metadata_fields)
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "/home/ray/anaconda3/lib/python3.11/site-packages/ray/_private/serialization.py", line 235, in _deserialize_msgpack_data
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m     python_objects = self._deserialize_pickle5_data(pickle5_data)
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "/home/ray/anaconda3/lib/python3.11/site-packages/ray/_private/serialization.py", line 225, in _deserialize_pickle5_data
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m     obj = pickle.loads(in_band)
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m           ^^^^^^^^^^^^^^^^^^^^^
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/working_dir_files/_ray_pkg_7ee52735570f7032/operations/download/__init__.py", line 1, in <module>
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m     from .huggingface.download import DownloadConfig as HfDownloadConfig
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/working_dir_files/_ray_pkg_7ee52735570f7032/operations/download/huggingface/download.py", line 22, in <module>
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m     from marin.execution.executor import THIS_OUTPUT_PATH
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/working_dir_files/_ray_pkg_7ee52735570f7032/marin/execution/__init__.py", line 1, in <module>
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m     from .executor import (
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/working_dir_files/_ray_pkg_7ee52735570f7032/marin/execution/executor.py", line 96, in <module>
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m     import levanter.utils.fsspec_utils as fsspec_utils
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/working_dir_files/_ray_pkg_7ee52735570f7032/submodules/levanter/src/levanter/__init__.py", line 1, in <module>
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m     import levanter.analysis as analysis
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/working_dir_files/_ray_pkg_7ee52735570f7032/submodules/levanter/src/levanter/analysis/__init__.py", line 1, in <module>
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m     from .entropy import cb_compute_entropies, cb_compute_top2_gap, compute_entropy_histogram, compute_top2_gap_histogram
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/working_dir_files/_ray_pkg_7ee52735570f7032/submodules/levanter/src/levanter/analysis/entropy.py", line 5, in <module>
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m     import equinox as eqx
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "/home/ray/anaconda3/lib/python3.11/site-packages/equinox/__init__.py", line 56, in <module>
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m     from ._sharding import filter_shard as filter_shard
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "/home/ray/anaconda3/lib/python3.11/site-packages/equinox/_sharding.py", line 5, in <module>
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m     from jaxlib.xla_extension import Device
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m ModuleNotFoundError: No module named 'jaxlib.xla_extension'
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m 'operations.download'
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m Traceback (most recent call last):
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "/home/ray/anaconda3/lib/python3.11/site-packages/ray/_private/serialization.py", line 423, in deserialize_objects
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m     obj = self._deserialize_object(data, metadata, object_ref)
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "/home/ray/anaconda3/lib/python3.11/site-packages/ray/_private/serialization.py", line 280, in _deserialize_object
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m     return self._deserialize_msgpack_data(data, metadata_fields)
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "/home/ray/anaconda3/lib/python3.11/site-packages/ray/_private/serialization.py", line 235, in _deserialize_msgpack_data
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m     python_objects = self._deserialize_pickle5_data(pickle5_data)
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "/home/ray/anaconda3/lib/python3.11/site-packages/ray/_private/serialization.py", line 225, in _deserialize_pickle5_data
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m     obj = pickle.loads(in_band)
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m           ^^^^^^^^^^^^^^^^^^^^^
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "<frozen importlib._bootstrap>", line 1138, in _find_and_load_unlocked
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "<frozen importlib._bootstrap>", line 1078, in _find_spec
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "<frozen importlib._bootstrap_external>", line 1507, in find_spec
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "<frozen importlib._bootstrap_external>", line 1473, in _get_spec
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "<frozen importlib._bootstrap_external>", line 1312, in __iter__
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "<frozen importlib._bootstrap_external>", line 1299, in _recalculate
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m   File "<frozen importlib._bootstrap_external>", line 1295, in _get_parent_path
[36m(execute_after_dependencies(download)::raw/dclm-baseline-1.0) pid=5641, ip=10.164.0.144)[0m KeyError: 'operations.download'
[36m(execute_after_dependencies(_failure_ok_train)::checkpoints/sweep-130m-5B-muony4ca27elr0.008-wd0.1-minlr0-warmup0-b10.8-b20.) pid=6041, ip=10.164.0.136)[0m     from marin.resources import ResourceConfig, TpuPodConfig
[36m(execute_after_dependencies(_failure_ok_train)::checkpoints/sweep-130m-5B-muony4ca27elr0.008-wd0.1-minlr0-warmup0-b10.8-b20.) pid=6041, ip=10.164.0.136)[0m     from levanter.utils.py_utils import logical_cpu_core_count
[36m(execute_after_dependencies(_failure_ok_train)::checkpoints/sweep-130m-5B-muony4ca27elr0.008-wd0.1-minlr0-warmup0-b10.8-b20.) pid=6041, ip=10.164.0.136)[0m     from .training import TrainLmOnPodConfig, run_levanter_train_lm
[36m(execute_after_dependencies(_failure_ok_train)::checkpoints/sweep-130m-5B-muony4ca27elr0.008-wd0.1-minlr0-warmup0-b10.8-b20.) pid=6041, ip=10.164.0.136)[0m     import levanter.infra.cli_helpers
2025-05-21 23:26:53,206	WARNING json_encoder.py:23 -- Could not serialize object of type <enum 'AttentionBackend'>: AttentionBackend.JAX_FLASH
2025-05-21 23:26:53,298	WARNING json_encoder.py:23 -- Could not serialize object of type <enum 'AttentionBackend'>: AttentionBackend.JAX_FLASH
2025-05-21 23:26:53,390	INFO executor.py:575 -- ### Waiting for all steps to finish ###
Traceback (most recent call last):
  File "/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/working_dir_files/_ray_pkg_7ee52735570f7032/experiments/optimizer_sweep/PhaseI_Bound/exp725_muonsweep_130M_2.py", line 9, in <module>
    template(model_size, target_chinchilla, 'muon', baseline_config, sweep_grids, random_suffix=my_suffix)
  File "/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/working_dir_files/_ray_pkg_7ee52735570f7032/marin/optimizer_sweep/template.py", line 99, in template
    executor_main(steps)
  File "/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/pip/1c7729883f499988ae1c2eb9d635f02bf39f3b05/virtualenv/lib/python3.11/site-packages/draccus/argparsing.py", line 228, in wrapper_inner
    response = fn(cfg, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/working_dir_files/_ray_pkg_7ee52735570f7032/marin/execution/executor.py", line 1113, in executor_main
    executor.run(steps=steps, dry_run=config.dry_run, run_only=config.run_only, force_run_failed=config.force_run_failed)
  File "/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/working_dir_files/_ray_pkg_7ee52735570f7032/marin/execution/executor.py", line 576, in run
    ray.get(list(self.refs.values()))
  File "/home/ray/anaconda3/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/ray/anaconda3/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/ray/anaconda3/lib/python3.11/site-packages/ray/_private/worker.py", line 2691, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ray/anaconda3/lib/python3.11/site-packages/ray/_private/worker.py", line 871, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(RaySystemError): [36mray::execute_after_dependencies(download)::raw/dclm-baseline-1.0)()[39m (pid=5641, ip=10.164.0.144)
  At least one of the input arguments for this task could not be computed:
ray.exceptions.RaySystemError: System error: No module named 'jaxlib.xla_extension'
traceback: Traceback (most recent call last):
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
          ^^^^^^^^^^^^^^^^^^^^^
  File "/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/working_dir_files/_ray_pkg_7ee52735570f7032/operations/download/__init__.py", line 1, in <module>
    from .huggingface.download import DownloadConfig as HfDownloadConfig
  File "/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/working_dir_files/_ray_pkg_7ee52735570f7032/operations/download/huggingface/download.py", line 22, in <module>
    from marin.execution.executor import THIS_OUTPUT_PATH
  File "/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/working_dir_files/_ray_pkg_7ee52735570f7032/marin/execution/__init__.py", line 1, in <module>
    from .executor import (
  File "/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/working_dir_files/_ray_pkg_7ee52735570f7032/marin/execution/executor.py", line 96, in <module>
    import levanter.utils.fsspec_utils as fsspec_utils
  File "/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/working_dir_files/_ray_pkg_7ee52735570f7032/submodules/levanter/src/levanter/__init__.py", line 1, in <module>
    import levanter.analysis as analysis
  File "/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/working_dir_files/_ray_pkg_7ee52735570f7032/submodules/levanter/src/levanter/analysis/__init__.py", line 1, in <module>
    from .entropy import cb_compute_entropies, cb_compute_top2_gap, compute_entropy_histogram, compute_top2_gap_histogram
  File "/tmp/ray/session_2025-04-09_11-16-26_352341_657/runtime_resources/working_dir_files/_ray_pkg_7ee52735570f7032/submodules/levanter/src/levanter/analysis/entropy.py", line 5, in <module>
    import equinox as eqx
  File "/home/ray/anaconda3/lib/python3.11/site-packages/equinox/__init__.py", line 56, in <module>
    from ._sharding import filter_shard as filter_shard
  File "/home/ray/anaconda3/lib/python3.11/site-packages/equinox/_sharding.py", line 5, in <module>
    from jaxlib.xla_extension import Device
ModuleNotFoundError: No module named 'jaxlib.xla_extension'
[36m(execute_after_dependencies(tokenize)::tokenized/proofpile_2) pid=2910, ip=10.164.0.34)[0m     from .data_configs import (
[36m(execute_after_dependencies(tokenize)::tokenized/proofpile_2) pid=2910, ip=10.164.0.34)[0m     from levanter.data.text import LMDatasetSourceConfig, LMMixtureDatasetConfig
[36m(execute_after_dependencies(tokenize)::tokenized/proofpile_2) pid=2910, ip=10.164.0.34)[0m     from .data_configs import (
[36m(execute_after_dependencies(tokenize)::tokenized/proofpile_2) pid=2910, ip=10.164.0.34)[0m     from levanter.data.text import LMDatasetSourceConfig, LMMixtureDatasetConfig
[36m(execute_after_dependencies(tokenize)::tokenized/paloma/mc4) pid=5992, ip=10.164.0.164)[0m No module named 'jaxlib.xla_extension'[32m [repeated 23x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(execute_after_dependencies(tokenize)::tokenized/paloma/mc4) pid=5992, ip=10.164.0.164)[0m Traceback (most recent call last):[32m [repeated 24x across cluster][0m
[36m(execute_after_dependencies(tokenize)::tokenized/paloma/mc4) pid=5992, ip=10.164.0.164)[0m   File "/home/ray/anaconda3/lib/python3.11/site-packages/ray/_private/serialization.py", line 423, in deserialize_objects[32m [repeated 24x across cluster][0m
[36m(execute_after_dependencies(tokenize)::tokenized/paloma/mc4) pid=5992, ip=10.164.0.164)[0m     obj = self._deserialize_object(data, metadata, object_ref)[32m [repeated 24x across cluster][0m
[36m(execute_after_dependencies(tokenize)::tokenized/paloma/mc4) pid=5992, ip=10.164.0.164)[0m           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[32m [repeated 24x across cluster][0m
[36m(execute_after_dependencies(tokenize)::tokenized/paloma/mc4) pid=5992, ip=10.164.0.164)[0m   File "/home/ray/anaconda3/lib/python3.11/site-packages/ray/_private/serialization.py", line 280, in _deserialize_object[32m [repeated 24x across cluster][0m
[36m(execute_after_dependencies(tokenize)::tokenized/paloma/mc4) pid=5992, ip=10.164.0.164)[0m     return self._deserialize_msgpack_data(data, metadata_fields)[32m [repeated 24x across cluster][0m
[36m(execute_after_dependencies(tokenize)::tokenized/paloma/mc4) pid=5992, ip=10.164.0.164)[0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[32m [repeated 24x across cluster][0m
[36m(execute_after_dependencies(tokenize)::tokenized/paloma/mc4) pid=5992, ip=10.164.0.164)[0m   File "/home/ray/anaconda3/lib/python3.11/site-packages/ray/_private/serialization.py", line 235, in _deserialize_msgpack_data[32m [repeated 24x across cluster][0m
[36m(execute_after_dependencies(tokenize)::tokenized/paloma/mc4) pid=5992, ip=10.164.0.164)[0m     python_objects = self._deserialize_pickle5_data(pickle5_data)[32m [repeated 24x across cluster][0m
[36m(execute_after_dependencies(tokenize)::tokenized/paloma/mc4) pid=5992, ip=10.164.0.164)[0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[32m [repeated 24x across cluster][0m
[36m(execute_after_dependencies(tokenize)::tokenized/paloma/mc4) pid=5992, ip=10.164.0.164)[0m   File "/home/ray/anaconda3/lib/python3.11/site-packages/ray/_private/serialization.py", line 225, in _deserialize_pickle5_data[32m [repeated 24x across cluster][0m
[36m(execute_after_dependencies(tokenize)::tokenized/paloma/mc4) pid=5992, ip=10.164.0.164)[0m     obj = pickle.loads(in_band)[32m [repeated 24x across cluster][0m
[36m(execute_after_dependencies(tokenize)::tokenized/paloma/mc4) pid=5992, ip=10.164.0.164)[0m           ^^^^^^^^^^^^^^^^^^^^^[32m [repeated 24x across cluster][0m
[36m(execute_after_dependencies(tokenize)::tokenized/paloma/mc4) pid=5992, ip=10.164.0.164)[0m   File "/home/ray/anaconda3/lib/python3.11/site-packages/equinox/_sharding.py", line 5, in <module>[32m [repeated 163x across cluster][0m
[36m(execute_after_dependencies(download_hf)::raw/starcoderdata) pid=2909, ip=10.164.0.34)[0m     from .huggingface.download import DownloadConfig as HfDownloadConfig
[36m(execute_after_dependencies(download_hf)::raw/starcoderdata) pid=2909, ip=10.164.0.34)[0m     from marin.execution.executor import THIS_OUTPUT_PATH
[36m(execute_after_dependencies(download_hf)::raw/starcoderdata) pid=2909, ip=10.164.0.34)[0m     from .executor import (
[36m(execute_after_dependencies(download_hf)::raw/starcoderdata) pid=2909, ip=10.164.0.34)[0m     import levanter.utils.fsspec_utils as fsspec_utils
[36m(execute_after_dependencies(tokenize)::tokenized/paloma/mc4) pid=5992, ip=10.164.0.164)[0m     import levanter.analysis as analysis[32m [repeated 23x across cluster][0m
[36m(execute_after_dependencies(tokenize)::tokenized/paloma/mc4) pid=5992, ip=10.164.0.164)[0m     from .entropy import cb_compute_entropies, cb_compute_top2_gap, compute_entropy_histogram, compute_top2_gap_histogram[32m [repeated 23x across cluster][0m
[36m(execute_after_dependencies(tokenize)::tokenized/paloma/mc4) pid=5992, ip=10.164.0.164)[0m     import equinox as eqx[32m [repeated 23x across cluster][0m
[36m(execute_after_dependencies(tokenize)::tokenized/paloma/mc4) pid=5992, ip=10.164.0.164)[0m     from ._sharding import filter_shard as filter_shard[32m [repeated 23x across cluster][0m
[36m(execute_after_dependencies(tokenize)::tokenized/paloma/mc4) pid=5992, ip=10.164.0.164)[0m     from jaxlib.xla_extension import Device[32m [repeated 23x across cluster][0m
[36m(execute_after_dependencies(tokenize)::tokenized/paloma/mc4) pid=5992, ip=10.164.0.164)[0m ModuleNotFoundError: No module named 'jaxlib.xla_extension'[32m [repeated 23x across cluster][0m
[36m(execute_after_dependencies(download_hf)::raw/starcoderdata) pid=2909, ip=10.164.0.34)[0m 'operations.download'
[36m(execute_after_dependencies(download_hf)::raw/starcoderdata) pid=2909, ip=10.164.0.34)[0m   File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
[36m(execute_after_dependencies(download_hf)::raw/starcoderdata) pid=2909, ip=10.164.0.34)[0m   File "<frozen importlib._bootstrap>", line 1138, in _find_and_load_unlocked
[36m(execute_after_dependencies(download_hf)::raw/starcoderdata) pid=2909, ip=10.164.0.34)[0m   File "<frozen importlib._bootstrap>", line 1078, in _find_spec
[36m(execute_after_dependencies(download_hf)::raw/starcoderdata) pid=2909, ip=10.164.0.34)[0m   File "<frozen importlib._bootstrap_external>", line 1507, in find_spec
[36m(execute_after_dependencies(download_hf)::raw/starcoderdata) pid=2909, ip=10.164.0.34)[0m   File "<frozen importlib._bootstrap_external>", line 1473, in _get_spec
[36m(execute_after_dependencies(download_hf)::raw/starcoderdata) pid=2909, ip=10.164.0.34)[0m   File "<frozen importlib._bootstrap_external>", line 1312, in __iter__
[36m(execute_after_dependencies(download_hf)::raw/starcoderdata) pid=2909, ip=10.164.0.34)[0m   File "<frozen importlib._bootstrap_external>", line 1299, in _recalculate
[36m(execute_after_dependencies(download_hf)::raw/starcoderdata) pid=2909, ip=10.164.0.34)[0m   File "<frozen importlib._bootstrap_external>", line 1295, in _get_parent_path
[36m(execute_after_dependencies(download_hf)::raw/starcoderdata) pid=2909, ip=10.164.0.34)[0m KeyError: 'operations.download'
[36m(execute_after_dependencies(tokenize)::tokenized/paloma/mc4) pid=5992, ip=10.164.0.164)[0m     from .data_configs import ([32m [repeated 18x across cluster][0m
[36m(execute_after_dependencies(tokenize)::tokenized/paloma/mc4) pid=5992, ip=10.164.0.164)[0m     from levanter.data.text import LMDatasetSourceConfig, LMMixtureDatasetConfig[32m [repeated 18x across cluster][0m
